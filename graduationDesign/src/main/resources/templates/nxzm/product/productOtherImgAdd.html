<div id="addProductOtherImgModel" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog"
     style="display: none">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                        aria-hidden="true">×</span></button>
                <h4 class="modal-title">添加商品其他图片</h4>
            </div>
            <div class="modal-body">


                <input type="hidden" id="product_other_img_product_id">
                <div class="form-group col-md-12">
                    <label>商品附图1</label>
                    <div class="form-controls">
                        <div id="show_futu_img_1" style="display: inline"></div>&nbsp;&nbsp;
                        <input style="display: inline;" type="file" id="fu_Image_1" name=""
                               accept="image/png, image/jpeg, image/jpg">
                        <button id="upload_product_fu_img_1">添加前请点击上传</button>
                    </div>
                    <input id="hidden_fu_img_1" type="hidden">
                </div>
                <div class="form-group col-md-12">
                    <label>商品附图2</label>
                    <div class="form-controls">
                        <div id="show_futu_img_2" style="display: inline"></div>&nbsp;&nbsp;
                        <input style="display: inline;" type="file" id="fu_Image_2" name=""
                               accept="image/png, image/jpeg, image/jpg">
                        <button id="upload_product_fu_img_2">添加前请点击上传</button>
                    </div>
                    <input id="hidden_fu_img_2" type="hidden">
                </div>
                <div class="form-group col-md-12">
                    <label>商品附图3</label>
                    <div class="form-controls">
                        <div id="show_futu_img_3" style="display: inline"></div>&nbsp;&nbsp;
                        <input style="display: inline;" type="file" id="fu_Image_3" name=""
                               accept="image/png, image/jpeg, image/jpg">
                        <button id="upload_product_fu_img_3">添加前请点击上传</button>
                    </div>
                    <input id="hidden_fu_img_3" type="hidden">
                </div>


                </form>

            </div>
            <div class="modal-footer">
                <button id="rProductOtherImgAddBtn" type="button" class="btn btn-default" data-dismiss="modal">确认添加
                </button>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript">


    //检查图片1
    $("#fu_Image_1").change(function () {
        var fileName = $("#fu_Image_1").val();
        fileName = fileName.replace("D:\\upload\\", "");
        var flag = true;
        if (fileName == "") {
            flag = false;
            alert("请选择图片");
        } else {
            var size = $("#fu_Image_1")[0].files[0].size;
            if (size / 1000 > 1024 * 2) {
                flag = false;
                alert("图片大小不能超过2MB");
            }
        }
        if (flag) {
            onLoadImage_fu_img1();
        } else {//清除input type=file的显示内容
            $("#fu_Image_1").val("");
        }
        return flag;
    })

    //预览图片1
    function onLoadImage_fu_img1() {
        var file = $('#fu_Image_1').get(0).files[0];
        var reader = new FileReader();
        //将文件以Data URL形式读入页面
        reader.readAsDataURL(file);
        reader.onload = function (e) {
            //显示文件"src", this.result
            $("#show_futu_img_1").html("<img style='width: 100px;height: 100px' src='" + this.result + "'>");
        }
    }


    //检查图片2
    $("#fu_Image_2").change(function () {
        var fileName = $("#fu_Image_2").val();
        fileName = fileName.replace("D:\\upload\\", "");
        var flag = true;
        if (fileName == "") {
            flag = false;
            alert("请选择图片");
        } else {
            var size = $("#fu_Image_2")[0].files[0].size;
            if (size / 1000 > 1024 * 2) {
                flag = false;
                alert("图片大小不能超过2MB");
            }
        }
        if (flag) {
            onLoadImage_fu_img2();
        } else {//清除input type=file的显示内容
            $("#fu_Image_2").val("");
        }
        return flag;
    })

    //预览图片2
    function onLoadImage_fu_img2() {
        var file = $('#fu_Image_2').get(0).files[0];
        var reader = new FileReader();
        //将文件以Data URL形式读入页面
        reader.readAsDataURL(file);
        reader.onload = function (e) {
            //显示文件"src", this.result
            $("#show_futu_img_2").html("<img style='width: 100px;height: 100px' src='" + this.result + "'>");
        }
    }

    //检查图片3
    $("#fu_Image_3").change(function () {
        var fileName = $("#fu_Image_3").val();
        fileName = fileName.replace("D:\\upload\\", "");
        var flag = true;
        if (fileName == "") {
            flag = false;
            alert("请选择图片");
        } else {
            var size = $("#fu_Image_3")[0].files[0].size;
            if (size / 1000 > 1024 * 2) {
                flag = false;
                alert("图片大小不能超过2MB");
            }
        }
        if (flag) {
            onLoadImage_fu_img3();
        } else {//清除input type=file的显示内容
            $("#fu_Image_3").val("");
        }
        return flag;
    })

    //预览图片3
    function onLoadImage_fu_img3() {
        var file = $('#fu_Image_3').get(0).files[0];
        var reader = new FileReader();
        //将文件以Data URL形式读入页面
        reader.readAsDataURL(file);
        reader.onload = function (e) {
            //显示文件"src", this.result
            $("#show_futu_img_3").html("<img style='width: 100px;height: 100px' src='" + this.result + "'>");
        }
    }

    //获取图片路径===附图1
    $("#upload_product_fu_img_1").on("click", function () {

        var formData = new FormData();
        formData.append("file", $("#fu_Image_1")[0].files[0]);
        //获取图片位置
        $.ajax({
            url: "/shone/product/product_fu_img",
            type: "post",
            contentType: "multipart/form-data",
            data: formData,
            processData: false,
            contentType: false,
            dataType: "json",
            success: function (path) {
                // console.log(path.object);
                $("#hidden_fu_img_1").val(path.object);
                alert("上传成功！")
            }
        })
    });

    //获取图片路径===附图2
    $("#upload_product_fu_img_2").on("click", function () {

        var formData = new FormData();
        formData.append("file", $("#fu_Image_2")[0].files[0]);
        //获取图片位置
        $.ajax({
            url: "/shone/product/product_fu_img",
            type: "post",
            contentType: "multipart/form-data",
            data: formData,
            processData: false,
            contentType: false,
            dataType: "json",
            success: function (path) {
                // console.log(path.object);
                $("#hidden_fu_img_2").val(path.object);
                alert("上传成功！")
            }
        })
    });

    //获取图片路径===附图3
    $("#upload_product_fu_img_3").on("click", function () {

        var formData = new FormData();
        formData.append("file", $("#fu_Image_3")[0].files[0]);
        //获取图片位置
        $.ajax({
            url: "/shone/product/product_fu_img",
            type: "post",
            contentType: "multipart/form-data",
            data: formData,
            processData: false,
            contentType: false,
            dataType: "json",
            success: function (path) {
                // console.log(path.object);
                $("#hidden_fu_img_3").val(path.object);
                alert("上传成功！")
            }
        })
    });

    //添加按钮
    $("#rProductOtherImgAddBtn").on("click", function () {
        // console.log(111);
        addProductOtherImg();
    })

    //添加商品
    function addProductOtherImg() {
        var fu1 = $("#hidden_fu_img_1").val();
        var fu2 = $("#hidden_fu_img_2").val();
        var fu3 = $("#hidden_fu_img_3").val();
        var product_id = $("#product_other_img_product_id").val();
        $.ajax({
            url: "/shone/product/fu_img_up",
            type: "post",
            data: {
                "productId":product_id,"fu_img1":fu1,"fu_img2":fu2,"fu_img3":fu3},
                dataType: "json",
                success: function (data) {
                    window.location.href = "/nxzm/product_other_image/product_other_images";
                },
                error: function () {

                }
            })
    }
</script>